(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-contribute-contribute"],{2267:function(t,e,i){"use strict";var n=i("288e");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("28a5");var a=n(i("795b"));i("ac6a"),i("5df3");var o={data:function(){return{form:{content:"",images:[]},maxNum:9}},onLoad:function(t){},onShow:function(){},components:{},computed:{access_token_weapp:function(){return this.$store.getters.access_token_weapp}},methods:{submitForm:function(t){this.submit()},submit:function(t){var e=this;console.log(t);var i=this.form;if(i.content){var n={url:"/tcb/invokecloudfunction?access_token="+this.access_token_weapp+"&name=saveJoke",data:{env:!0,content:i.content,images:i.images.map(function(t){return t.file_id}).join(",")}};console.log(n),this.$requestWX(n).then(function(t){e.$toast.success("投稿成功"),e.form={content:"",images:[]}}).catch(function(t){console.log(t),e.$toast("投稿失败")})}else this.$toast("请输入搞笑文字")},delImage:function(t){var e=this.form.images;e.splice(t,1),this.form.images=e},clickImage:function(t){uni.previewImage({current:t,urls:this.form.images.map(function(t){return t.filePath})})},upload:function(){var t=this,e=this.form.images,i=this.maxNum,n=i-e.length;0!=n?uni.chooseImage({count:n,sizeType:["compressed"],sourceType:["album","camera"],success:function(e){e.tempFilePaths.length>0&&uni.showLoading({title:"正在上传图片"});for(var i=[],n=function(n){var o=new a.default(function(i,a){t.uploadImage(e.tempFilePaths[n],i)});i.push(o)},o=0;o<e.tempFilePaths.length;o++)n(o);a.default.all(i).then(function(e){console.log("Promise.all->",e),t.form.images=t.form.images.concat(e),wx.hideLoading()})}}):this.$toast("最多上传"+i+"张图片")},uploadImage:function(t,e){var i=t.split("/"),n="".concat([i[i.length-1]],".gif"),a="h5/img/".concat(n),o={url:"/tcb/uploadfile?access_token="+this.access_token_weapp,data:{env:!0,path:a}};this.$requestWX(o).then(function(i){console.log("uploadfile->>",i),console.log("file_id：",i.file_id),uni.uploadFile({url:i.url,filePath:t,name:"file",formData:{key:a,Signature:i.authorization,"x-cos-security-token":i.token,"x-cos-meta-fileid":i.cos_file_id},success:function(n){console.log(n),"uploadFile:ok"==n.errMsg&&e({file_id:i.file_id,filePath:t})},complete:function(){uni.hideLoading()}})}).catch(function(t){})}},onReady:function(){},onHide:function(){},onUnload:function(){}};e.default=o},"2f0f":function(t,e,i){var n=i("dc3d");"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var a=i("4f06").default;a("15a35508",n,!0,{sourceMap:!1,shadowMode:!1})},"3f68":function(t,e,i){"use strict";var n=i("2f0f"),a=i.n(n);a.a},4079:function(t,e,i){"use strict";i.r(e);var n=i("7446"),a=i("d3a8");for(var o in a)"default"!==o&&function(t){i.d(e,t,function(){return a[t]})}(o);i("3f68");var s=i("2877"),c=Object(s["a"])(a["default"],n["a"],n["b"],!1,null,"779bc1c2",null);e["default"]=c.exports},7446:function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"contribute-page"},[i("v-uni-form",{attrs:{"report-submit":"ture"},on:{submit:function(e){e=t.$handleEvent(e),t.submitForm(e)}}},[i("v-uni-view",{staticClass:"textarea-wrap"},[i("v-uni-textarea",{staticClass:"input",attrs:{placeholder:"请输入搞笑文字...",maxlength:"2000"},model:{value:t.form.content,callback:function(e){t.$set(t.form,"content",e)},expression:"form.content"}})],1),t.form.images.length>0?i("v-uni-view",{staticClass:"images-wrap"},t._l(t.form.images,function(e,n){return i("v-uni-view",{key:n,staticClass:"images"},[i("img",{staticClass:"img",attrs:{src:e.filePath,mode:"aspectFill"},on:{click:function(i){i.stopPropagation(),i.preventDefault(),i=t.$handleEvent(i),t.clickImage(e.filePath)}}}),i("span",{staticClass:"icon icon-del",on:{click:function(e){e.stopPropagation(),e.preventDefault(),e=t.$handleEvent(e),t.delImage(n)}}})])}),1):t._e(),t.form.images.length<t.maxNum?i("v-uni-view",{staticClass:"addbtn-wrap"},[i("v-uni-button",{staticClass:"addbtn",attrs:{type:"text","hover-class":"active"},on:{click:function(e){e=t.$handleEvent(e),t.upload(e)}}},[i("v-uni-text",{staticClass:"icon icon-add"})],1)],1):t._e(),i("v-uni-view",{staticClass:"btn-wrap"},[i("v-uni-button",{staticClass:"submit-btn",attrs:{type:"primary",formType:"submit","data-type":"submit"}},[t._v("投稿")]),i("v-uni-view",{staticClass:"tips-wrap"},[i("v-uni-view",{staticClass:"tips"},[t._v("按相关规定，投稿后24小时内审核。")]),i("v-uni-view",{staticClass:"tips"},[t._v("投稿内容不允许涉及政治敏感与黄赌毒")])],1)],1)],1)],1)},a=[];i.d(e,"a",function(){return n}),i.d(e,"b",function(){return a})},d3a8:function(t,e,i){"use strict";i.r(e);var n=i("2267"),a=i.n(n);for(var o in n)"default"!==o&&function(t){i.d(e,t,function(){return n[t]})}(o);e["default"]=a.a},dc3d:function(t,e,i){e=t.exports=i("2350")(!1),e.push([t.i,".contribute-page[data-v-779bc1c2]{padding:%?30?%}.contribute-page .textarea-wrap[data-v-779bc1c2]{border:%?2?% dashed #eee;margin-bottom:%?20?%;border-radius:%?8?%;padding:%?20?%}.contribute-page .textarea-wrap .input[data-v-779bc1c2]{height:%?320?%;background-color:#fff;-webkit-box-sizing:border-box;box-sizing:border-box;width:100%;font-size:%?28?%;line-height:1.4;color:#333}.contribute-page .images-wrap[data-v-779bc1c2]{margin-bottom:%?20?%}.contribute-page .images-wrap .images[data-v-779bc1c2]{position:relative;display:inline-block;text-align:center;height:%?190?%;width:%?190?%;margin-right:%?30?%;margin-top:%?30?%}.contribute-page .images-wrap .images .img[data-v-779bc1c2]{border:%?1?% dashed #f2f2f2;border-radius:%?8?%;overflow:hidden;height:%?190?%;text-align:center;width:%?190?%}.contribute-page .images-wrap .images .icon[data-v-779bc1c2]{z-index:1;color:#ef8b20;position:absolute;font-size:%?40?%;top:%?-20?%;right:%?-20?%}.contribute-page .addbtn-wrap .addbtn[data-v-779bc1c2]{width:%?190?%;height:%?190?%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;border:%?2?% solid #ef8b20;border-radius:%?8?%;-webkit-box-sizing:border-box;box-sizing:border-box}.contribute-page .addbtn-wrap .addbtn .icon[data-v-779bc1c2]{line-height:1;color:#ef8b20;font-size:%?80?%}.contribute-page .btn-wrap[data-v-779bc1c2]{margin-top:%?50?%}.contribute-page .btn-wrap .tips-wrap[data-v-779bc1c2]{margin-top:%?30?%}.contribute-page .btn-wrap .tips-wrap .tips[data-v-779bc1c2]{font-size:%?24?%;margin-top:%?10?%;color:#9b9b9b;text-align:center}.contribute-page .img-wrap[data-v-779bc1c2]{width:%?140?%;height:%?140?%;margin-right:%?40?%;border-radius:100%;-webkit-box-sizing:border-box;box-sizing:border-box;overflow:hidden;display:-webkit-flex;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-justify-content:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;position:relative;box-sizing:border-box;border:%?6?% solid #e6e6e6}",""])}}]);